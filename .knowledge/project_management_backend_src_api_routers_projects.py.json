{"is_source_file": true, "format": "Python", "description": "This source file defines API routes for managing projects within a project management backend. It includes endpoints for listing, creating, updating, deleting, and exporting projects as CSV. It relies on FastAPI for routing and SQLAlchemy ORM for database interactions. The file also contains helper functions for data transformation and validation related to projects.", "external_files": ["src.api.deps", "src.api.schemas.project", "src.db.models", "src.db.session"], "external_methods": ["get_current_user", "get_db", "select", "func.coalesce"], "published": ["router", "_to_project_response", "_ensure_client_belongs_to_user", "_date_to_iso", "export_projects_csv", "list_projects", "get_project", "create_project", "update_project", "delete_project"], "classes": [], "methods": [{"name": "ProjectResponse _to_project_response(project: Project)", "description": "Converts a Project ORM instance to a ProjectResponse schema object.", "scope": "", "scopeKind": ""}, {"name": "None _ensure_client_belongs_to_user(db: Session, current_user: User, client_id: uuid.UUID)", "description": "Checks if a client belongs to the current user, raises HTTP 404 if not.", "scope": "", "scopeKind": ""}, {"name": "str _date_to_iso(d: date | None)", "description": "Serializes a date object to ISO string, or empty string if None.", "scope": "", "scopeKind": ""}, {"name": "Response export_projects_csv( db: Session = Depends(get_db), current_user: User = Depends(get_current_user), )", "description": "Exports all projects of the current user as a downloadable CSV file.", "scope": "", "scopeKind": ""}, {"name": "list[ProjectResponse] list_projects( db: Session = Depends(get_db), current_user: User = Depends(get_current_user), q: str | None = Query(None, description=\"Optional search query (matches project name/description).\"), status_filter: ProjectStatus | None = Query(None, alias=\"status\", description=\"Optional status filter.\"), client_id: uuid.UUID | None = Query(None, description=\"Optional filter by client id.\"), limit: int = Query(50, ge=1, le=200, description=\"Page size.\"), offset: int = Query(0, ge=0, description=\"Offset for pagination.\"), )", "description": "Lists projects for the current user with optional search, status, and client filters.", "scope": "", "scopeKind": ""}, {"name": "ProjectResponse get_project( project_id: uuid.UUID, db: Session = Depends(get_db), current_user: User = Depends(get_current_user), )", "description": "Fetches a single project by its ID for the current user.", "scope": "", "scopeKind": ""}, {"name": "ProjectResponse create_project( payload: ProjectCreateRequest, db: Session = Depends(get_db), current_user: User = Depends(get_current_user), )", "description": "Creates a new project owned by the current user.", "scope": "", "scopeKind": ""}, {"name": "ProjectResponse update_project( project_id: uuid.UUID, payload: ProjectUpdateRequest, db: Session = Depends(get_db), current_user: User = Depends(get_current_user), )", "description": "Updates fields of an existing project owned by the current user.", "scope": "", "scopeKind": ""}, {"name": "Response delete_project( project_id: uuid.UUID, db: Session = Depends(get_db), current_user: User = Depends(get_current_user), )", "description": "Deletes a project owned by the current user.", "scope": "", "scopeKind": ""}], "calls": ["select", "func.coalesce", "db.execute", "db.scalar", "db.add", "db.commit", "db.refresh", "db.delete"], "search-terms": ["projects.py", "project management API", "CSV export", "FastAPI router", "Project CRUD", "project filtering", "Projects endpoint", "SQLAlchemy query"], "state": 2, "file_id": 22, "knowledge_revision": 52, "git_revision": "21a424521e24d09b43043df909149282f9bd2829", "revision_history": [{"48": "016f735b2a270ef4a67b21424faadf5ffd3f5b1a"}, {"52": "21a424521e24d09b43043df909149282f9bd2829"}], "ctags": [{"_type": "tag", "name": "_date_to_iso", "path": "/home/kavia/workspace/code-generation/digital-agency-management-dashboard-303880-303889/project_management_backend/src/api/routers/projects.py", "pattern": "/^def _date_to_iso(d: date | None) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "(d: date | None)"}, {"_type": "tag", "name": "_ensure_client_belongs_to_user", "path": "/home/kavia/workspace/code-generation/digital-agency-management-dashboard-303880-303889/project_management_backend/src/api/routers/projects.py", "pattern": "/^def _ensure_client_belongs_to_user(db: Session, current_user: User, client_id: uuid.UUID) -> Non/", "language": "Python", "typeref": "typename:None", "kind": "function", "signature": "(db: Session, current_user: User, client_id: uuid.UUID)"}, {"_type": "tag", "name": "_to_project_response", "path": "/home/kavia/workspace/code-generation/digital-agency-management-dashboard-303880-303889/project_management_backend/src/api/routers/projects.py", "pattern": "/^def _to_project_response(project: Project) -> ProjectResponse:$/", "language": "Python", "typeref": "typename:ProjectResponse", "kind": "function", "signature": "(project: Project)"}, {"_type": "tag", "name": "create_project", "path": "/home/kavia/workspace/code-generation/digital-agency-management-dashboard-303880-303889/project_management_backend/src/api/routers/projects.py", "pattern": "/^def create_project($/", "language": "Python", "typeref": "typename:ProjectResponse", "kind": "function", "signature": "( payload: ProjectCreateRequest, db: Session = Depends(get_db), current_user: User = Depends(get_current_user), )"}, {"_type": "tag", "name": "delete_project", "path": "/home/kavia/workspace/code-generation/digital-agency-management-dashboard-303880-303889/project_management_backend/src/api/routers/projects.py", "pattern": "/^def delete_project($/", "language": "Python", "typeref": "typename:Response", "kind": "function", "signature": "( project_id: uuid.UUID, db: Session = Depends(get_db), current_user: User = Depends(get_current_user), )"}, {"_type": "tag", "name": "export_projects_csv", "path": "/home/kavia/workspace/code-generation/digital-agency-management-dashboard-303880-303889/project_management_backend/src/api/routers/projects.py", "pattern": "/^def export_projects_csv($/", "language": "Python", "typeref": "typename:Response", "kind": "function", "signature": "( db: Session = Depends(get_db), current_user: User = Depends(get_current_user), )"}, {"_type": "tag", "name": "get_project", "path": "/home/kavia/workspace/code-generation/digital-agency-management-dashboard-303880-303889/project_management_backend/src/api/routers/projects.py", "pattern": "/^def get_project($/", "language": "Python", "typeref": "typename:ProjectResponse", "kind": "function", "signature": "( project_id: uuid.UUID, db: Session = Depends(get_db), current_user: User = Depends(get_current_user), )"}, {"_type": "tag", "name": "list_projects", "path": "/home/kavia/workspace/code-generation/digital-agency-management-dashboard-303880-303889/project_management_backend/src/api/routers/projects.py", "pattern": "/^def list_projects($/", "language": "Python", "typeref": "typename:list[ProjectResponse]", "kind": "function", "signature": "( db: Session = Depends(get_db), current_user: User = Depends(get_current_user), q: str | None = Query(None, description=\"Optional search query (matches project name/description).\"), status_filter: ProjectStatus | None = Query(None, alias=\"status\", description=\"Optional status filter.\"), client_id: uuid.UUID | None = Query(None, description=\"Optional filter by client id.\"), limit: int = Query(50, ge=1, le=200, description=\"Page size.\"), offset: int = Query(0, ge=0, description=\"Offset for pagination.\"), )"}, {"_type": "tag", "name": "router", "path": "/home/kavia/workspace/code-generation/digital-agency-management-dashboard-303880-303889/project_management_backend/src/api/routers/projects.py", "pattern": "/^router = APIRouter(prefix=\"\\/projects\", tags=[\"projects\"])$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "update_project", "path": "/home/kavia/workspace/code-generation/digital-agency-management-dashboard-303880-303889/project_management_backend/src/api/routers/projects.py", "pattern": "/^def update_project($/", "language": "Python", "typeref": "typename:ProjectResponse", "kind": "function", "signature": "( project_id: uuid.UUID, payload: ProjectUpdateRequest, db: Session = Depends(get_db), current_user: User = Depends(get_current_user), )"}], "hash": "ee835570b43617eb68287decd1189164", "format-version": 4, "code-base-name": "project_management_backend", "filename": "project_management_backend/src/api/routers/projects.py", "fields": [{"name": "router = APIRouter(prefix=\"\\/projects\", tags=[\"projects\"])", "scope": "", "scopeKind": "", "description": "unavailable"}]}